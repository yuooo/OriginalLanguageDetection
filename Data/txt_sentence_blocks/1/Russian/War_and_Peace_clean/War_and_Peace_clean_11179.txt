Rostov took the joke as an insult , flared up , and said such unpleasant things to the officer that it was all Denisov could do to prevent a duel . 
